import os
from PIL import Image
import logging
folder_path = r'E:\MalwareDataset\sophos\splitted_malware_images\val\benign'
extensions = ['jpg']
corrupted = []


for fldr in os.listdir(folder_path):
    # sub_folder_path = os.path.join(folder_path, fldr)
    # for filee in os.listdir(sub_folder_path):
    file_path = os.path.join(folder_path, fldr)
    print('** Path: {}  **'.format(file_path), end="\r", flush=True)

    try:
        im = Image.open(file_path)
        rgb_im = im.convert('RGB')

    except Exception as e:

        logging.error(e)
        corrupted.append(file_path)
        # if filee.split('.')[1] not in extensions:
        #     extensions.append(filee.split('.')[1])

logging.warning(extensions)

with open('corrupted.txt', 'w') as f:
    for item in corrupted:
        f.write("%s\n" % item)